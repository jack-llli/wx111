<!--pages/cart/cart.wxml-->
<view class="page">
  <!-- 购物车为空 -->
  <view class="empty-cart" wx:if="{{cart.length === 0}}">
    <image class="empty-icon" src="/images/empty-cart.png" mode="aspectFit"></image>
    <view class="empty-text">购物车空空如也</view>
    <button class="btn-primary" bindtap="goToIndex">去选课</button>
  </view>

  <!-- 购物车列表 -->
  <view class="cart-content" wx:else>
    <view class="cart-list">
      <view class="cart-item card" wx:for="{{cart}}" wx:key="id">
        <!-- 选择框 -->
        <view class="item-select" bindtap="toggleSelect" data-id="{{item.id}}">
          <view class="checkbox {{item.selected ? 'checked' : ''}}">
            <text class="icon" wx:if="{{item.selected}}">✓</text>
          </view>
        </view>

        <!-- 课程图片 -->
        <image class="item-image" src="{{item.image}}" mode="aspectFill"></image>

        <!-- 课程信息 -->
        <view class="item-info">
          <view class="item-name">{{item.name}}</view>
          <view class="item-price price">
            <text class="price-symbol">¥</text>
            <text class="price-int">{{item.price}}</text>
          </view>
          
          <!-- 数量控制 -->
          <view class="item-count">
            <button class="count-btn" bindtap="decreaseCount" data-id="{{item.id}}">-</button>
            <input class="count-input" type="number" value="{{item.count}}" bindinput="inputCount" data-id="{{item.id}}"></input>
            <button class="count-btn" bindtap="increaseCount" data-id="{{item.id}}">+</button>
          </view>
        </view>

        <!-- 删除按钮 -->
        <view class="item-delete" bindtap="deleteItem" data-id="{{item.id}}">
          <text class="delete-icon">×</text>
        </view>
      </view>
    </view>

    <!-- 底部结算栏 -->
    <view class="cart-footer">
      <view class="footer-select" bindtap="toggleAllSelect">
        <view class="checkbox {{allSelected ? 'checked' : ''}}">
          <text class="icon" wx:if="{{allSelected}}">✓</text>
        </view>
        <text class="select-text">全选</text>
      </view>

      <view class="footer-total">
        <text class="total-label">合计：</text>
        <text class="price">
          <text class="price-symbol">¥</text>
          <text class="price-int">{{totalPrice}}</text>
        </text>
      </view>

      <button class="checkout-btn" bindtap="checkout">
        去结算({{selectedCount}})
      </button>
    </view>
  </view>
</view>
